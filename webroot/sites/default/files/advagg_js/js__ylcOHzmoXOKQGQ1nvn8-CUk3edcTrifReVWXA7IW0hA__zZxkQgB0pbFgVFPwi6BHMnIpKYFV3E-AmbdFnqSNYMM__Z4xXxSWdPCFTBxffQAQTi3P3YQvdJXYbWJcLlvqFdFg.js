/* Source and licensing information for the line(s) below can be found at https://projektballast.dk/misc/tabledrag.js. */
(function(e){Drupal.behaviors.tableDrag={attach:function(t,r){for(var a in r.tableDrag){e('#'+a,t).once('tabledrag',function(){Drupal.tableDrag[a]=new Drupal.tableDrag(this,r.tableDrag[a])})}}};Drupal.tableDrag=function(t,r){var a=this;this.table=t;this.tableSettings=r;this.dragObject=null;this.rowObject=null;this.oldRowElement=null;this.oldY=0;this.changed=!1;this.maxDepth=0;this.rtl=e(this.table).css('direction')=='rtl'?-1:1;this.scrollSettings={amount:4,interval:50,trigger:70};this.scrollInterval=null;this.scrollY=0;this.windowHeight=0;this.indentEnabled=!1;for(var n in r){for(var i in r[n]){if(r[n][i].relationship=='parent'){this.indentEnabled=!0};if(r[n][i].limit>0){this.maxDepth=r[n][i].limit}}};if(this.indentEnabled){this.indentCount=1;var o=Drupal.theme('tableDragIndentation'),l=e('<tr/>').addClass('draggable').appendTo(t),s=e('<td/>').appendTo(l).prepend(o).prepend(o);this.indentAmount=e('.indentation',s).get(1).offsetLeft-e('.indentation',s).get(0).offsetLeft;l.remove()};e('> tr.draggable, > tbody > tr.draggable',t).each(function(){a.makeDraggable(this)});e(t).before(e('<a href="#" class="tabledrag-toggle-weight"></a>').attr('title',Drupal.t('Re-order rows by numerical weight instead of dragging.')).click(function(){if(e.cookie('Drupal.tableDrag.showWeight')==1){a.hideColumns()}
else{a.showColumns()};return!1}).wrap('<div class="tabledrag-toggle-weight-wrapper"></div>').parent());a.initColumns();e(document).bind('mousemove pointermove',function(e){return a.dragRow(e,a)});e(document).bind('mouseup pointerup',function(e){return a.dropRow(e,a)});e(document).bind('touchmove',function(e){return a.dragRow(e.originalEvent.touches[0],a)});e(document).bind('touchend',function(e){return a.dropRow(e.originalEvent.touches[0],a)})};Drupal.tableDrag.prototype.initColumns=function(){for(var r in this.tableSettings){for(var a in this.tableSettings[r]){var n=e('.'+this.tableSettings[r][a].target+':first',this.table);if(n.length&&this.tableSettings[r][a].hidden){var o=this.tableSettings[r][a].hidden,t=n.closest('td');break}};if(o&&t[0]){var i=e('> td',t.parent()).index(t.get(0))+1;e('> thead > tr, > tbody > tr, > tr',this.table).each(function(){var r=i,a=e(this).children();a.each(function(e){if(e<r&&this.colSpan&&this.colSpan>1){r-=this.colSpan-1}});if(r>0){t=a.filter(':nth-child('+r+')');if(t[0].colSpan&&t[0].colSpan>1){t.addClass('tabledrag-has-colspan')}
else{t.addClass('tabledrag-hide')}}})}};if(e.cookie('Drupal.tableDrag.showWeight')===null){e.cookie('Drupal.tableDrag.showWeight',0,{path:Drupal.settings.basePath,expires:365});this.hideColumns()}
else{if(e.cookie('Drupal.tableDrag.showWeight')==1){this.showColumns()}
else{this.hideColumns()}}};Drupal.tableDrag.prototype.hideColumns=function(){e('.tabledrag-hide','table.tabledrag-processed').css('display','none');e('.tabledrag-handle','table.tabledrag-processed').css('display','');e('.tabledrag-has-colspan','table.tabledrag-processed').each(function(){this.colSpan=this.colSpan-1});e('.tabledrag-toggle-weight').text(Drupal.t('Show row weights'));e.cookie('Drupal.tableDrag.showWeight',0,{path:Drupal.settings.basePath,expires:365});e('table.tabledrag-processed').trigger('columnschange','hide')};Drupal.tableDrag.prototype.showColumns=function(){e('.tabledrag-hide','table.tabledrag-processed').css('display','');e('.tabledrag-handle','table.tabledrag-processed').css('display','none');e('.tabledrag-has-colspan','table.tabledrag-processed').each(function(){this.colSpan=this.colSpan+1});e('.tabledrag-toggle-weight').text(Drupal.t('Hide row weights'));e.cookie('Drupal.tableDrag.showWeight',1,{path:Drupal.settings.basePath,expires:365});e('table.tabledrag-processed').trigger('columnschange','show')};Drupal.tableDrag.prototype.rowSettings=function(t,r){var l=e('.'+t,r);for(var a in this.tableSettings[t]){var o=this.tableSettings[t][a].target;if(l.is('.'+o)){var i={};for(var n in this.tableSettings[t][a]){i[n]=this.tableSettings[t][a][n]};return i}}};Drupal.tableDrag.prototype.makeDraggable=function(r){var t=this,a=e('<a href="#" class="tabledrag-handle"><div class="handle">&nbsp;</div></a>').attr('title',Drupal.t('Drag to re-order'));if(e('td:first .indentation:last',r).length){e('td:first .indentation:last',r).after(a);t.indentCount=Math.max(e('.indentation',r).length,t.indentCount)}
else{e('td:first',r).prepend(a)};a.hover(function(){t.dragObject==null?e(this).addClass('tabledrag-handle-hover'):null},function(){t.dragObject==null?e(this).removeClass('tabledrag-handle-hover'):null});a.bind('mousedown touchstart pointerdown',function(a){if(a.originalEvent.type=='touchstart'){a=a.originalEvent.touches[0]};t.dragObject={};t.dragObject.initMouseOffset=t.getMouseOffset(r,a);t.dragObject.initMouseCoords=t.mouseCoords(a);if(t.indentEnabled){t.dragObject.indentMousePos=t.dragObject.initMouseCoords};if(t.rowObject){e('a.tabledrag-handle',t.rowObject.element).blur()};t.rowObject=new t.row(r,'mouse',t.indentEnabled,t.maxDepth,!0);t.table.topY=e(t.table).offset().top;t.table.bottomY=t.table.topY+t.table.offsetHeight;e(this).addClass('tabledrag-handle-hover');e(r).addClass('drag');e('body').addClass('drag');if(t.oldRowElement){e(t.oldRowElement).removeClass('drag-previous')};if(navigator.userAgent.indexOf('MSIE 6.')!=-1){e('select',this.table).css('display','none')};t.safeBlur=!1;t.onDrag();return!1});a.click(function(){return!1});a.focus(function(){e(this).addClass('tabledrag-handle-hover');t.safeBlur=!0});a.blur(function(r){e(this).removeClass('tabledrag-handle-hover');if(t.rowObject&&t.safeBlur){t.dropRow(r,t)}});a.keydown(function(n){if(n.keyCode!=9&&!t.rowObject){t.rowObject=new t.row(r,'keyboard',t.indentEnabled,t.maxDepth,!0)};var s=!1;switch(n.keyCode){case 37:case 63234:s=!0;t.rowObject.indent(-1*t.rtl);break;case 38:case 63232:var i=e(t.rowObject.element).prev('tr').get(0);while(i&&e(i).is(':hidden')){i=e(i).prev('tr').get(0)};if(i){t.safeBlur=!1;t.rowObject.direction='up';s=!0;if(e(r).is('.tabledrag-root')){var l=0;while(i&&e('.indentation',i).length){i=e(i).prev('tr').get(0);l+=e(i).is(':hidden')?0:i.offsetHeight};if(i){t.rowObject.swap('before',i);window.scrollBy(0,-l)}}
else if(t.table.tBodies[0].rows[0]!=i||e(i).is('.draggable')){t.rowObject.swap('before',i);t.rowObject.interval=null;t.rowObject.indent(0);window.scrollBy(0,-parseInt(r.offsetHeight,10))};a.get(0).focus()};break;case 39:case 63235:s=!0;t.rowObject.indent(1*t.rtl);break;case 40:case 63233:var o=e(t.rowObject.group).filter(':last').next('tr').get(0);while(o&&e(o).is(':hidden')){o=e(o).next('tr').get(0)};if(o){t.safeBlur=!1;t.rowObject.direction='down';s=!0;if(e(r).is('.tabledrag-root')){var l=0,d=new t.row(o,'keyboard',t.indentEnabled,t.maxDepth,!1);if(d){e(d.group).each(function(){l+=e(this).is(':hidden')?0:this.offsetHeight});var h=e(d.group).filter(':last').get(0);t.rowObject.swap('after',h);window.scrollBy(0,parseInt(l,10))}}
else{t.rowObject.swap('after',o);t.rowObject.interval=null;t.rowObject.indent(0);window.scrollBy(0,parseInt(r.offsetHeight,10))};a.get(0).focus()};break};if(t.rowObject&&t.rowObject.changed==!0){e(r).addClass('drag');if(t.oldRowElement){e(t.oldRowElement).removeClass('drag-previous')};t.oldRowElement=r;t.restripeTable();t.onDrag()};if(s){return!1}});a.keypress(function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:return!1}})};Drupal.tableDrag.prototype.dragRow=function(t,e){if(e.dragObject){e.currentMouseCoords=e.mouseCoords(t);var r=e.currentMouseCoords.y-e.dragObject.initMouseOffset.y,s=e.currentMouseCoords.x-e.dragObject.initMouseOffset.x;if(r!=e.oldY){e.rowObject.direction=r>e.oldY?'down':'up';e.oldY=r;var n=e.checkScroll(e.currentMouseCoords.y);clearInterval(e.scrollInterval);if(n>0&&e.rowObject.direction=='down'||n<0&&e.rowObject.direction=='up'){e.setScroll(n)};var a=e.findDropTargetRow(s,r);if(a){if(e.rowObject.direction=='down'){e.rowObject.swap('after',a,e)}
else{e.rowObject.swap('before',a,e)};e.restripeTable()}};if(e.indentEnabled){var i=e.currentMouseCoords.x-e.dragObject.indentMousePos.x,o=Math.round(i/e.indentAmount),l=e.rowObject.indent(o);e.dragObject.indentMousePos.x+=e.indentAmount*l*e.rtl;e.indentCount=Math.max(e.indentCount,e.rowObject.indents)};return!1}};Drupal.tableDrag.prototype.dropRow=function(r,t){if(t.rowObject!=null){var a=t.rowObject.element;if(t.rowObject.changed==!0){t.updateFields(a);for(var n in t.tableSettings){var o=t.rowSettings(n,a);if(o.relationship=='group'){for(var i in t.rowObject.children){t.updateField(t.rowObject.children[i],n)}}};t.rowObject.markChanged();if(t.changed==!1){e(Drupal.theme('tableDragChangedWarning')).insertBefore(t.table).hide().fadeIn('slow');t.changed=!0}};if(t.indentEnabled){t.rowObject.removeIndentClasses()};if(t.oldRowElement){e(t.oldRowElement).removeClass('drag-previous')};e(a).removeClass('drag').addClass('drag-previous');t.oldRowElement=a;t.onDrop();t.rowObject=null};if(t.dragObject!=null){e('.tabledrag-handle',a).removeClass('tabledrag-handle-hover');t.dragObject=null;e('body').removeClass('drag');clearInterval(t.scrollInterval);if(navigator.userAgent.indexOf('MSIE 6.')!=-1){e('select',this.table).css('display','block')}}};Drupal.tableDrag.prototype.mouseCoords=function(e){if(e.pageX!=null&&e.pageY!=null){return{x:e.pageX,y:e.pageY}};if(e.originalEvent&&e.originalEvent.pageX!=null&&e.originalEvent.pageY!=null){return{x:e.originalEvent.pageX,y:e.originalEvent.pageY}};if(e.clientX==null||e.clientY==null){if(!e.originalEvent){throw new Error('The event has no coordinates, and no event.originalEvent.')};e=e.originalEvent;if(e.clientX==null||e.clientY==null){throw new Error('The original event has no coordinates.')}};var t=document.documentElement,r=document.body,a=e.clientX+(t&&t.scrollLeft||r&&r.scrollLeft||0)-(t&&t.clientLeft||r&&r.clientLeft||0),n=e.clientY+(t&&t.scrollTop||r&&r.scrollTop||0)-(t&&t.clientTop||r&&r.clientTop||0);return{x:a,y:n}};Drupal.tableDrag.prototype.getMouseOffset=function(t,r){var a=e(t).offset(),n=this.mouseCoords(r);return{x:n.x-a.left,y:n.y-a.top}};Drupal.tableDrag.prototype.findDropTargetRow=function(t,r){var l=e(this.table.tBodies[0].rows).not(':hidden');for(var n=0;n<l.length;n++){var a=l[n],s=0,o=e(a).offset().top;if(a.offsetHeight==0){var i=parseInt(a.firstChild.offsetHeight,10)/2}
else{var i=parseInt(a.offsetHeight,10)/2};if((r>(o-i))&&(r<(o+i))){if(this.indentEnabled){for(var n in this.rowObject.group){if(this.rowObject.group[n]==a){return null}}}
else{if(a==this.rowObject.element){return null}};if(!this.rowObject.isValidSwap(a)){return null}
while(e(a).is(':hidden')&&e(a).prev('tr').is(':hidden')){a=e(a).prev('tr').get(0)};return a}};return null};Drupal.tableDrag.prototype.updateFields=function(e){for(var t in this.tableSettings){this.updateField(e,t)}};Drupal.tableDrag.prototype.updateField=function(t,r){var n=this.rowSettings(r,t);if(n.relationship=='self'||n.relationship=='group'){var i=t}
else if(n.relationship=='sibling'){var a=e(t).prev('tr').get(0),s=e(t).next('tr').get(0),i=t;if(e(a).is('.draggable')&&e('.'+r,a).length){if(this.indentEnabled){if(e('.indentations',a).length==e('.indentations',t)){i=a}}
else{i=a}}
else if(e(s).is('.draggable')&&e('.'+r,s).length){if(this.indentEnabled){if(e('.indentations',s).length==e('.indentations',t)){i=s}}
else{i=s}}}
else if(n.relationship=='parent'){var a=e(t).prev('tr');while(a.length&&e('.indentation',a).length>=this.rowObject.indents){a=a.prev('tr')};if(a.length){i=a[0]}
else{i=e(this.table).find('tr.draggable:first').get(0);if(i==this.rowObject.element){i=e(this.rowObject.group[this.rowObject.group.length-1]).next('tr.draggable').get(0)};var b=!0}};this.copyDragClasses(i,t,r);n=this.rowSettings(r,t);if(b){n.relationship='sibling';n.source=n.target};var d='.'+n.target,l=e(d,t).get(0);if(l){var u='.'+n.source,c=e(u,i).get(0);switch(n.action){case'depth':l.value=e('.indentation',e(c).closest('tr')).length;break;case'match':l.value=c.value;break;case'order':var h=this.rowObject.findSiblings(n);if(e(l).is('select')){var o=[];e('option',l).each(function(){o.push(this.value)});var p=o[o.length-1];e(d,h).each(function(){if(o.length>0){this.value=o.shift()}
else{this.value=p}})}
else{var g=parseInt(e(d,h[0]).val(),10)||0;e(d,h).each(function(){this.value=g;g++})};break}}};Drupal.tableDrag.prototype.copyDragClasses=function(t,r,a){var n=e('.'+a,t),i=e('.'+a,r);if(n.length&&i.length){i[0].className=n[0].className}};Drupal.tableDrag.prototype.checkScroll=function(e){var a=document.documentElement,i=document.body,o=this.windowHeight=window.innerHeight||(a.clientHeight&&a.clientWidth!=0?a.clientHeight:i.offsetHeight),n=this.scrollY=(document.all?(!a.scrollTop?i.scrollTop:a.scrollTop):(window.pageYOffset?window.pageYOffset:window.scrollY)),r=this.scrollSettings.trigger,t=0;if(e-n>o-r){t=r/(o+n-e);t=(t>0&&t<r)?t:r;return t*this.scrollSettings.amount}
else if(e-n<r){t=r/(e-n);t=(t>0&&t<r)?t:r;return-t*this.scrollSettings.amount}};Drupal.tableDrag.prototype.setScroll=function(e){var t=this;this.scrollInterval=setInterval(function(){t.checkScroll(t.currentMouseCoords.y);var r=t.scrollY>t.table.topY,a=t.scrollY+t.windowHeight<t.table.bottomY;if(e>0&&a||e<0&&r){window.scrollBy(0,e)}},this.scrollSettings.interval)};Drupal.tableDrag.prototype.restripeTable=function(){e('> tbody > tr.draggable:visible, > tr.draggable:visible',this.table).removeClass('odd even').filter(':odd').addClass('even').end().filter(':even').addClass('odd')};Drupal.tableDrag.prototype.onDrag=function(){return null};Drupal.tableDrag.prototype.onDrop=function(){return null};Drupal.tableDrag.prototype.row=function(t,r,n,i,o){this.element=t;this.method=r;this.group=[t];this.groupDepth=e('.indentation',t).length;this.changed=!1;this.table=e(t).closest('table').get(0);this.indentEnabled=n;this.maxDepth=i;this.direction='';if(this.indentEnabled){this.indents=e('.indentation',t).length;this.children=this.findChildren(o);this.group=e.merge(this.group,this.children);for(var a=0;a<this.group.length;a++){this.groupDepth=Math.max(e('.indentation',this.group[a]).length,this.groupDepth)}}};Drupal.tableDrag.prototype.row.prototype.findChildren=function(t){var a=this.indents,r=e(this.element,this.table).next('tr.draggable'),n=[],i=0;while(r.length){var o=e('.indentation',r).length;if(o>a){i++;n.push(r[0]);if(t){e('.indentation',r).each(function(t){if(i==1&&(t==a)){e(this).addClass('tree-child-first')};if(t==a){e(this).addClass('tree-child')}
else if(t>a){e(this).addClass('tree-child-horizontal')}})}}
else{break};r=r.next('tr.draggable')};if(t&&n.length){e('.indentation:nth-child('+(a+1)+')',n[n.length-1]).addClass('tree-child-last')};return n};Drupal.tableDrag.prototype.row.prototype.isValidSwap=function(t){if(this.indentEnabled){var r,a;if(this.direction=='down'){r=t;a=e(t).next('tr').get(0)}
else{r=e(t).prev('tr').get(0);a=t};this.interval=this.validIndentInterval(r,a);if(this.interval.min>this.interval.max){return!1}};if(this.table.tBodies[0].rows[0]==t&&e(t).is(':not(.draggable)')){return!1};return!0};Drupal.tableDrag.prototype.row.prototype.swap=function(t,r){Drupal.detachBehaviors(this.group,Drupal.settings,'move');e(r)[t](this.group);Drupal.attachBehaviors(this.group,Drupal.settings);this.changed=!0;this.onSwap(r)};Drupal.tableDrag.prototype.row.prototype.validIndentInterval=function(t,r){var n,a;n=r?e('.indentation',r).length:0;if(!t||e(t).is(':not(.draggable)')||e(this.element).is('.tabledrag-root')){a=0}
else{a=e('.indentation',t).length+(e(t).is('.tabledrag-leaf')?0:1);if(this.maxDepth){a=Math.min(a,this.maxDepth-(this.groupDepth-this.indents))}};return{'min':n,'max':a}};Drupal.tableDrag.prototype.row.prototype.indent=function(t){if(!this.interval){var n=e(this.element).prev('tr').get(0),i=e(this.group).filter(':last').next('tr').get(0);this.interval=this.validIndentInterval(n,i)};var r=this.indents+t;r=Math.max(r,this.interval.min);r=Math.min(r,this.interval.max);t=r-this.indents;for(var a=1;a<=Math.abs(t);a++){if(t<0){e('.indentation:first',this.group).remove();this.indents--}
else{e('td:first',this.group).prepend(Drupal.theme('tableDragIndentation'));this.indents++}};if(t){this.changed=!0;this.groupDepth+=t;this.onIndent()};return t};Drupal.tableDrag.prototype.row.prototype.findSiblings=function(t){var n=[],i=['prev','next'],l=this.indents;for(var a=0;a<i.length;a++){var r=e(this.element)[i[a]]();while(r.length){if(e('.'+t.target,r)){if(this.indentEnabled){var o=e('.indentation',r).length};if(!(this.indentEnabled)||(o==l)){n.push(r[0])}
else if(o<l){break}}
else{break};r=e(r)[i[a]]()};if(i[a]=='prev'){n.reverse();n.push(this.element)}};return n};Drupal.tableDrag.prototype.row.prototype.removeIndentClasses=function(){for(var t in this.children){e('.indentation',this.children[t]).removeClass('tree-child').removeClass('tree-child-first').removeClass('tree-child-last').removeClass('tree-child-horizontal')}};Drupal.tableDrag.prototype.row.prototype.markChanged=function(){var r=Drupal.theme('tableDragChangedMarker'),t=e('td:first',this.element);if(e('span.tabledrag-changed',t).length==0){t.append(r)}};Drupal.tableDrag.prototype.row.prototype.onIndent=function(){return null};Drupal.tableDrag.prototype.row.prototype.onSwap=function(e){return null};Drupal.theme.prototype.tableDragChangedMarker=function(){return'<span class="warning tabledrag-changed">*</span>'};Drupal.theme.prototype.tableDragIndentation=function(){return'<div class="indentation">&nbsp;</div>'};Drupal.theme.prototype.tableDragChangedWarning=function(){return'<div class="tabledrag-changed-warning messages warning">'+Drupal.theme('tableDragChangedMarker')+' '+Drupal.t('Changes made in this table will not be saved until the form is submitted.')+'</div>'}})(jQuery);;
/* Source and licensing information for the above line(s) can be found at https://projektballast.dk/misc/tabledrag.js. */
;/*})'"*/
